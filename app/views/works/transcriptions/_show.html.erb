<section class="work-transcription">

  <% if @work && !@work.cross_edition_work_set.nil? %>
    <ul>
        <% @work.cross_edition_work_set.all_works.each do |other_work| %>
            <%= render partial: 'works/list_item', locals: { work: other_work, edition: other_work.edition } %>
        <% end %>
    </ul>
  <% end %>

    <%= render partial: 'shared/forms/edition_selector' %>
    <%= link_to "New", new_edition_path %>
    <% if @work %>
    <h3><%= @edition.work_number_prefix %><%= @work.number %> <%= @work.variant %></h3>
  <label>
      <input id="no-edits" type="checkbox" name="edits" value="no" />Hide edits</label>
  <label>
      <input id="linebreak-emily" type="checkbox" name="linebreak" value="emily" />Emily's line breaks</label>

    <div class="work-body">
    <% @work.stanzas.each do |stanza| %>
        <p class="stanza" data-number="<%= stanza.position %>">
        <% stanza.lines.each do |line| %>
            <span class="line" data-line="<%= line.number %>">
                <%= raw render_line(line) %>
                <% unless line.just_author_break? %>
                    <br class="emily author"/>
                <% end %>
            </span>
        <% end %>
        </p>
    <% end %>
    </div>
<% else %>
    <% if @edition.owner == current_user %>
        <%= link_to 'Create new transcription', new_edition_work_path(@edition) %>
    <% else %>
    <p><em>No transcription of this image</em></p>
    <% end %>
<% end %>
    <h3>Related Works in This Edition</h3>
    <ul>
        <% @work.variants.each do |work| %>
            <%= render partial: 'works/list_item', locals: {work: work, edition: @edition || work.edition} %>
        <% end %>
    </ul>
</section>
