<section class="interactive-image <%= 'missing-image' if @image.nil? || @image.url.empty? %>">
  <% if @image.nil? || @image.url.empty? %>
    <%= image_tag asset_path("missing_image.jpg") %>
  <% else %>
      <div id="page-image"></div>
      <%= javascript_include_tag "openseadragon" %>
      <script>
            OpenSeadragon({
                id:            "page-image",
                prefixUrl: '/assets/',
                tileSources: '<%= "#{Eda::Application.config.emily['image_host']}?DeepZoom=#{Eda::Application.config.emily['image_directory']}/#{@image.url}.tif.dzi" %>'
            });
      </script>
  <% end %>

  <div class="page-controls">
    <% if previous_page = @image_set.root.leaf_before(@image_set) %>
        <%=
            link_to('', edition_image_set_url(@edition, previous_page), {
                id: 'prev-page', title: 'Previous Page', alt: 'Previous Page', class: 'change-page'
            })
        %> 
    <% end %>

    <%= link_to('', image_set_url(@edition, @image), { id: 'sbs-view', title: 'Reading View', alt: 'Reading View' }) if @image %>

    <%= if next_page = @image_set.root.leaf_after(@image_set)
            link_to( '', edition_image_set_url( {
                edition_id: @edition, id: next_page.id
            } ), {
                id: 'next-page', title: 'Next Page', alt: 'Next Page', class: 'change-page'
            } );
    end %>
  </div>

  <% if @image %>
  <dl class="credits">
      <%= render :partial => 'shared/metadata', :object => @image %>
      <dt>Credits</dt><dd><%= @image.credits %></dd>
  </dl>
  <% end %>
</section>

